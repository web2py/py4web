

<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>YATL 中的助手（helpers） &mdash; py4web 20251209 文档</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/css/toggle.css?v=029c1802" />

  
    <link rel="shortcut icon" href="_static/logo-32x32.ico"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=96e44453"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/translations.js?v=beaddf03"></script>
      <script src="_static/js/toggle.js?v=e1b5a5a1"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="国际化" href="chapter-11.html" />
    <link rel="prev" title="YATL 模板语言" href="chapter-09.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            py4web
              <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <p class="caption" role="heading"><span class="caption-text">目录</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="chapter-01.html">py4web 是什么？</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter-02.html">帮助、资源和提示</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter-03.html">安装和启动</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter-04.html">Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter-05.html">创建一个应用</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter-06.html">夹具（Fixture）</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter-07.html">数据库抽象层（DAL）</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter-08.html">RestAPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter-09.html">YATL 模板语言</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">YATL 中的助手（helpers）</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#helpers-overview">助手（helpers）概览</a></li>
<li class="toctree-l2"><a class="reference internal" href="#built-in-helpers">内置的 helpers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#xml"><code class="docutils literal notranslate"><span class="pre">XML</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#a"><code class="docutils literal notranslate"><span class="pre">A</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#body"><code class="docutils literal notranslate"><span class="pre">BODY</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#cat"><code class="docutils literal notranslate"><span class="pre">CAT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#div"><code class="docutils literal notranslate"><span class="pre">DIV</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#em"><code class="docutils literal notranslate"><span class="pre">EM</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#form"><code class="docutils literal notranslate"><span class="pre">FORM</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#h1-h2-h3-h4-h5-h6"><code class="docutils literal notranslate"><span class="pre">H1</span></code>, <code class="docutils literal notranslate"><span class="pre">H2</span></code>, <code class="docutils literal notranslate"><span class="pre">H3</span></code>, <code class="docutils literal notranslate"><span class="pre">H4</span></code>, <code class="docutils literal notranslate"><span class="pre">H5</span></code>, <code class="docutils literal notranslate"><span class="pre">H6</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#head"><code class="docutils literal notranslate"><span class="pre">HEAD</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#html"><code class="docutils literal notranslate"><span class="pre">HTML</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#i"><code class="docutils literal notranslate"><span class="pre">I</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#img"><code class="docutils literal notranslate"><span class="pre">IMG</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#input"><code class="docutils literal notranslate"><span class="pre">INPUT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#label"><code class="docutils literal notranslate"><span class="pre">LABEL</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#li"><code class="docutils literal notranslate"><span class="pre">LI</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ol"><code class="docutils literal notranslate"><span class="pre">OL</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#option"><code class="docutils literal notranslate"><span class="pre">OPTION</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#p"><code class="docutils literal notranslate"><span class="pre">P</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pre"><code class="docutils literal notranslate"><span class="pre">PRE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#script"><code class="docutils literal notranslate"><span class="pre">SCRIPT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#select"><code class="docutils literal notranslate"><span class="pre">SELECT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#span"><code class="docutils literal notranslate"><span class="pre">SPAN</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#style"><code class="docutils literal notranslate"><span class="pre">STYLE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#table-tr-td"><code class="docutils literal notranslate"><span class="pre">TABLE</span></code>, <code class="docutils literal notranslate"><span class="pre">TR</span></code>, <code class="docutils literal notranslate"><span class="pre">TD</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tbody"><code class="docutils literal notranslate"><span class="pre">TBODY</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#textarea"><code class="docutils literal notranslate"><span class="pre">TEXTAREA</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#th"><code class="docutils literal notranslate"><span class="pre">TH</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#thead"><code class="docutils literal notranslate"><span class="pre">THEAD</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#title"><code class="docutils literal notranslate"><span class="pre">TITLE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tt"><code class="docutils literal notranslate"><span class="pre">TT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ul"><code class="docutils literal notranslate"><span class="pre">UL</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#url"><code class="docutils literal notranslate"><span class="pre">URL</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#custom-helpers">自定义 helper</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tag"><code class="docutils literal notranslate"><span class="pre">TAG</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#beautify"><code class="docutils literal notranslate"><span class="pre">BEAUTIFY</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#server-side-dom">服务器端的 <em>DOM</em></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#children"><code class="docutils literal notranslate"><span class="pre">children</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#find"><code class="docutils literal notranslate"><span class="pre">find</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-inject">使用 <em>注入</em></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chapter-11.html">国际化</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter-12.html">表单（Forms）</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter-13.html">身份验证与授权</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter-14.html">表格（Grid）</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter-15.html">从 web2py 迁移到 py4web</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter-16.html">高级主题和示例</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">py4web</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">YATL 中的助手（helpers）</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/web2py/py4web/blob/master/docs/chapter-10.rst" class="fa fa-github"> 在 GitHub 上编辑</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="yatl-helpers">
<h1>YATL 中的助手（helpers）<a class="headerlink" href="#yatl-helpers" title="Link to this heading"></a></h1>
<section id="helpers-overview">
<h2>助手（helpers）概览<a class="headerlink" href="#helpers-overview" title="Link to this heading"></a></h2>
<p>假设在一个模板中有如下代码：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[[=DIV(&#39;this&#39;, &#39;is&#39;, &#39;a&#39;, &#39;test&#39;, _id=&#39;123&#39;, _class=&#39;myclass&#39;)]]
</pre></div>
</div>
<p>它被呈现为：</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;123&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;myclass&quot;</span><span class="p">&gt;</span>thisisatest<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>通过复制 _scaffold 应用程序（请参阅 <a class="reference internal" href="chapter-05.html#copying-the-scaffold-app"><span class="std std-ref">复制 _scaffold 应用</span></a> ），然后编辑文件 <code class="docutils literal notranslate"><span class="pre">new_app/template/index.html</span></code> ，您可以轻松测试这些命令的渲染。</p>
<p><code class="docutils literal notranslate"><span class="pre">DIV</span></code> 是一个  <strong>helper class</strong> ，即可用于以编程方式构建 HTML 的东西。它对应于 HTML 的 <code class="docutils literal notranslate"><span class="pre">&lt;div&gt;</span></code> 标签。</p>
<p>助手（Helper）可以有：</p>
<ul class="simple">
<li><p><strong>位置参数</strong>，被解释为 <em>开始</em> 和 <em>结束</em> 标记之间包含的对象，如前一个示例中的 <code class="docutils literal notranslate"><span class="pre">thisisatest</span></code></p></li>
<li><p><strong>下划线开头的命名参数</strong>，被解释为 HTML 标签属性（不带下划线），如上例中的 <code class="docutils literal notranslate"><span class="pre">_class</span></code> 和 <code class="docutils literal notranslate"><span class="pre">_id</span></code></p></li>
<li><p><strong>命名参数</strong> （不以下划线开头），这些参数是特定于标记的。</p></li>
</ul>
<p>helper 也可以使用 <code class="docutils literal notranslate"><span class="pre">*</span></code> 符号将单个列表或元组作为其组件集来代替使用一组未命名的参数，并且可以使用 <code class="docutils literal notranslate"><span class="pre">**</span></code> 符号将单个字典作为其属性集，例如：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[[
contents = [&#39;this&#39;, &#39;is&#39;, &#39;a&#39;, &#39;test&#39;]
attributes = {&#39;_id&#39;:&#39;123&#39;, &#39;_class&#39;:&#39;myclass&#39;}
=DIV(*contents, **attributes)
]]
</pre></div>
</div>
<p>产生与前面相同的输出）。</p>
<p>以下是 YATL 模块中当前可用的助手集（helpers）：</p>
<p><code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">BEAUTIFY</span></code>, <code class="docutils literal notranslate"><span class="pre">BODY</span></code>, <code class="docutils literal notranslate"><span class="pre">CAT</span></code>, <code class="docutils literal notranslate"><span class="pre">CODE</span></code>, <code class="docutils literal notranslate"><span class="pre">DIV</span></code>, <code class="docutils literal notranslate"><span class="pre">EM</span></code>,
<code class="docutils literal notranslate"><span class="pre">FORM</span></code>, <code class="docutils literal notranslate"><span class="pre">H1</span></code>, <code class="docutils literal notranslate"><span class="pre">H2</span></code>, <code class="docutils literal notranslate"><span class="pre">H3</span></code>, <code class="docutils literal notranslate"><span class="pre">H4</span></code>, <code class="docutils literal notranslate"><span class="pre">H5</span></code>, <code class="docutils literal notranslate"><span class="pre">H6</span></code>, <code class="docutils literal notranslate"><span class="pre">HEAD</span></code>,
<code class="docutils literal notranslate"><span class="pre">HTML</span></code>, <code class="docutils literal notranslate"><span class="pre">IMG</span></code>, <code class="docutils literal notranslate"><span class="pre">INPUT</span></code>, <code class="docutils literal notranslate"><span class="pre">LABEL</span></code>, <code class="docutils literal notranslate"><span class="pre">LI</span></code>, <code class="docutils literal notranslate"><span class="pre">METATAG</span></code>,
<code class="docutils literal notranslate"><span class="pre">OL</span></code>, <code class="docutils literal notranslate"><span class="pre">OPTION</span></code>, <code class="docutils literal notranslate"><span class="pre">P</span></code>, <code class="docutils literal notranslate"><span class="pre">PRE</span></code>, <code class="docutils literal notranslate"><span class="pre">SELECT</span></code>, <code class="docutils literal notranslate"><span class="pre">SPAN</span></code>, <code class="docutils literal notranslate"><span class="pre">STRONG</span></code>,
<code class="docutils literal notranslate"><span class="pre">TABLE</span></code>, <code class="docutils literal notranslate"><span class="pre">TAG</span></code>, <code class="docutils literal notranslate"><span class="pre">TAGGER</span></code>, <code class="docutils literal notranslate"><span class="pre">THEAD</span></code>, <code class="docutils literal notranslate"><span class="pre">TBODY</span></code>, <code class="docutils literal notranslate"><span class="pre">TD</span></code>,
<code class="docutils literal notranslate"><span class="pre">TEXTAREA</span></code>, <code class="docutils literal notranslate"><span class="pre">TH</span></code>, <code class="docutils literal notranslate"><span class="pre">TT</span></code>, <code class="docutils literal notranslate"><span class="pre">TR</span></code>, <code class="docutils literal notranslate"><span class="pre">UL</span></code>, <code class="docutils literal notranslate"><span class="pre">XML</span></code>, <code class="docutils literal notranslate"><span class="pre">xmlescape</span></code>,
<code class="docutils literal notranslate"><span class="pre">I</span></code>, <code class="docutils literal notranslate"><span class="pre">META</span></code>, <code class="docutils literal notranslate"><span class="pre">LINK</span></code>, <code class="docutils literal notranslate"><span class="pre">TITLE</span></code>, <code class="docutils literal notranslate"><span class="pre">STYLE</span></code>, <code class="docutils literal notranslate"><span class="pre">SCRIPT</span></code></p>
<p>可用 helper 构建复杂的表达式，然后可以将其序列化为 XML。例如：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[[=DIV(STRONG(I(&quot;hello &quot;, &quot;&lt;world&gt;&quot;)), _class=&quot;myclass&quot;)]]
</pre></div>
</div>
<p>被呈现为：</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;myclass&quot;</span><span class="p">&gt;&lt;</span><span class="nt">strong</span><span class="p">&gt;&lt;</span><span class="nt">i</span><span class="p">&gt;</span>hello <span class="ni">&amp;lt;</span>world<span class="ni">&amp;gt;</span><span class="p">&lt;/</span><span class="nt">i</span><span class="p">&gt;&lt;/</span><span class="nt">strong</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>也可以使用 <code class="docutils literal notranslate"><span class="pre">__str__</span></code> 和 <code class="docutils literal notranslate"><span class="pre">xml</span></code> 方法将 helper 等效地序列化为字符串。这可以直接使用 Python shell 或使用 py4web 的 <a class="reference internal" href="chapter-03.html#shell-command-option"><span class="std std-ref">shell 命令行选项</span></a> 进行手动测试，例如：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">yatl.helpers</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">DIV</span><span class="p">(</span><span class="s2">&quot;hello world&quot;</span><span class="p">))</span>
<span class="go">&#39;&lt;div&gt;hello world&lt;/div&gt;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DIV</span><span class="p">(</span><span class="s2">&quot;hello world&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">xml</span><span class="p">()</span>
<span class="go">&#39;&lt;div&gt;hello world&lt;/div&gt;&#39;</span>
</pre></div>
</div>
<p>py4web 中的 helper 机制不仅仅是一个在不连接成字符串的情况下生成 HTML 的系统。它提供了文档对象模型（DOM）的服务器端表示。</p>
<p>helper 内包含的组件可以通过其位置进行引用，外层 helper 充当其内部组件的列表：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DIV</span><span class="p">(</span><span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&lt;div&gt;&lt;span&gt;ab&lt;/span&gt;c&lt;/div&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">STRONG</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&lt;div&gt;&lt;span&gt;yb&lt;/span&gt;&lt;strong&gt;x&lt;/strong&gt;&lt;/div&gt;</span>
</pre></div>
</div>
<p>helpers 的属性可以通过名称引用，helper 充当其属性作为键的字典：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DIV</span><span class="p">(</span><span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;s&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&lt;div class=&quot;s&quot;&gt;&lt;span class=&quot;t&quot;&gt;ab&lt;/span&gt;c&lt;/div&gt;</span>
</pre></div>
</div>
<p>请注意，可以通过一个名为 <code class="docutils literal notranslate"><span class="pre">a.children</span></code> 的列表访问完整的组件集；可以通过名为  <code class="docutils literal notranslate"><span class="pre">a.attributes</span></code> 的字典访问完整的属性集。因此，当 <code class="docutils literal notranslate"><span class="pre">i</span></code> 是整数时， <code class="docutils literal notranslate"><span class="pre">a[i]</span></code> 等价于 <code class="docutils literal notranslate"><span class="pre">a.children[i]</span></code> ；当 <code class="docutils literal notranslate"><span class="pre">s</span></code> 是字符串时， <code class="docutils literal notranslate"><span class="pre">a[s]</span></code> 等价于 <code class="docutils literal notranslate"><span class="pre">a.attributes[s]</span></code> 。</p>
<p>请注意， helper 的属性作为关键字参数传递给 helper 。然而，在某些情况下，属性名称包含 Python 标识符中不允许的特殊字符（例如连字符），因此不能用作关键字参数名称。例如：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DIV</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">_data</span><span class="o">-</span><span class="n">role</span><span class="o">=</span><span class="s1">&#39;collapsible&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>将不起作用，因为 “_data-role” 包含连字符，这将产生 Python 语法错误。</p>
<p>在这种情况下，您可以将属性作为字典传递，并使用 Python 函数的  <code class="docutils literal notranslate"><span class="pre">**</span></code> 参数表示法，该表示法将字典中的每项（key:value）映射到一组关键字参数中：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">DIV</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;_data-role&#39;</span><span class="p">:</span> <span class="s1">&#39;collapsible&#39;</span><span class="p">}))</span>
<span class="go">&lt;div data-role=&quot;collapsible&quot;&gt;text&lt;/div&gt;</span>
</pre></div>
</div>
<p>您还可以动态创建特殊 TAG：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">TAG</span><span class="p">[</span><span class="s1">&#39;soap:Body&#39;</span><span class="p">](</span><span class="s1">&#39;whatever&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;_xmlns:m&#39;</span><span class="p">:</span><span class="s1">&#39;http://www.example.org&#39;</span><span class="p">}))</span>
<span class="go">&lt;soap:Body xmlns:m=&quot;http://www.example.org&quot;&gt;whatever&lt;/soap:Body&gt;</span>
</pre></div>
</div>
</section>
<section id="built-in-helpers">
<h2>内置的 helpers<a class="headerlink" href="#built-in-helpers" title="Link to this heading"></a></h2>
<section id="xml">
<span id="id1"></span><h3><code class="docutils literal notranslate"><span class="pre">XML</span></code><a class="headerlink" href="#xml" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">XML</span></code> 是一个 helper 对象，用于封装 <strong>不应被转义</strong> 的文本。文本可能包含也可能不包含有效的 XML；例如，它可以包含 JavaScript 。</p>
<p>在下面示例中的文本被转义了：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">DIV</span><span class="p">(</span><span class="s2">&quot;&lt;strong&gt;hello&lt;/strong&gt;&quot;</span><span class="p">))</span>
<span class="go">&lt;div&gt;&amp;lt;strong&amp;gt;hello&amp;lt;/strong&amp;gt;&lt;/div&gt;</span>
</pre></div>
</div>
<p>使用 <code class="docutils literal notranslate"><span class="pre">XML</span></code> 能防止被转义：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">DIV</span><span class="p">(</span><span class="n">XML</span><span class="p">(</span><span class="s2">&quot;&lt;strong&gt;hello&lt;/strong&gt;&quot;</span><span class="p">)))</span>
<span class="go">&lt;div&gt;&lt;strong&gt;hello&lt;/strong&gt;&lt;/div&gt;</span>
</pre></div>
</div>
<p>有时，你需要渲染存储在一个变量中的 HTML，但是其中可能包含像 script 这类不安全的标签：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;script&gt;alert(&quot;unsafe!&quot;)&lt;/script&gt;&#39;</span><span class="p">))</span>
<span class="go">&lt;script&gt;alert(&quot;unsafe!&quot;)&lt;/script&gt;</span>
</pre></div>
</div>
<p>像这样未转义的可执行输入（例如，在博客的评论正文中输入）是不安全的，因为它可用于对页面的其他访问者生成跨站脚本（XSS）攻击。在这种情况下，py4web 的  <code class="docutils literal notranslate"><span class="pre">XML</span></code> helper 可以净化我们的文本，以防止注入和转义所有标签，但明确允许的标签除外。以下是一个示例：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;script&gt;alert(&quot;unsafe!&quot;)&lt;/script&gt;&#39;</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">&amp;lt;script&amp;gt;alert(&amp;quot;unsafe!&amp;quot;)&amp;lt;/script&amp;gt;</span>
</pre></div>
</div>
<p>默认情况下， <code class="docutils literal notranslate"><span class="pre">XML</span></code> 构造函数认为某些标记的内容及其某些属性是安全的。您可以使用可选的 <code class="docutils literal notranslate"><span class="pre">permitted_tags</span></code> 和 <code class="docutils literal notranslate"><span class="pre">allowed_attributes</span></code> 参数覆盖默认值。以下是 <code class="docutils literal notranslate"><span class="pre">XML</span></code> helper 的可选参数的默认值。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">XML</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">sanitize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">permitted_tags</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;blockquote&#39;</span><span class="p">,</span> <span class="s1">&#39;br/&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;li&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ol&#39;</span><span class="p">,</span> <span class="s1">&#39;ul&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;cite&#39;</span><span class="p">,</span> <span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;pre&#39;</span><span class="p">,</span> <span class="s1">&#39;img/&#39;</span><span class="p">,</span>
        <span class="s1">&#39;h1&#39;</span><span class="p">,</span> <span class="s1">&#39;h2&#39;</span><span class="p">,</span> <span class="s1">&#39;h3&#39;</span><span class="p">,</span> <span class="s1">&#39;h4&#39;</span><span class="p">,</span> <span class="s1">&#39;h5&#39;</span><span class="p">,</span> <span class="s1">&#39;h6&#39;</span><span class="p">,</span> <span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="s1">&#39;tr&#39;</span><span class="p">,</span> <span class="s1">&#39;td&#39;</span><span class="p">,</span>
        <span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="s1">&#39;strong&#39;</span><span class="p">,</span> <span class="s1">&#39;span&#39;</span><span class="p">],</span>
    <span class="n">allowed_attributes</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;href&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;target&#39;</span><span class="p">],</span>
        <span class="s1">&#39;img&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;src&#39;</span><span class="p">,</span> <span class="s1">&#39;alt&#39;</span><span class="p">],</span> <span class="s1">&#39;blockquote&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="s1">&#39;td&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;colspan&#39;</span><span class="p">]})</span>
</pre></div>
</div>
</section>
<section id="a">
<h3><code class="docutils literal notranslate"><span class="pre">A</span></code><a class="headerlink" href="#a" title="Link to this heading"></a></h3>
<p>此 helper 用于构建链接。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="s1">&#39;&lt;click&gt;&#39;</span><span class="p">,</span> <span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;me&lt;/strong&gt;&#39;</span><span class="p">),</span>
<span class="go">            _href=&#39;http://www.py4web.com&#39;))</span>
<span class="go">&lt;a href=&quot;http://www.py4web.com&quot;&gt;&amp;lt;click&amp;gt;&lt;strong&gt;me&lt;/strong&gt;&lt;/a&gt;</span>
</pre></div>
</div>
</section>
<section id="body">
<h3><code class="docutils literal notranslate"><span class="pre">BODY</span></code><a class="headerlink" href="#body" title="Link to this heading"></a></h3>
<p>此 helper 构成页面的主体。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">BODY</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">,</span> <span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">),</span> <span class="n">_bgcolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">))</span>
<span class="go">&lt;body bgcolor=&quot;red&quot;&gt;&amp;lt;hello&amp;gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/body&gt;</span>
</pre></div>
</div>
</section>
<section id="cat">
<h3><code class="docutils literal notranslate"><span class="pre">CAT</span></code><a class="headerlink" href="#cat" title="Link to this heading"></a></h3>
<p>此 helper 连接其它 helpers 。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">CAT</span><span class="p">(</span><span class="s1">&#39;Here is a &#39;</span><span class="p">,</span> <span class="n">A</span><span class="p">(</span><span class="s1">&#39;link&#39;</span><span class="p">,</span> <span class="n">_href</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">),</span> <span class="s1">&#39;, and here is some &#39;</span><span class="p">,</span> <span class="n">STRONG</span><span class="p">(</span><span class="s1">&#39;bold text&#39;</span><span class="p">),</span> <span class="s1">&#39;.&#39;</span><span class="p">))</span>
<span class="go">Here is a &lt;a href=&quot;target&quot;&gt;link&lt;/a&gt;, and here is some &lt;strong&gt;bold text&lt;/strong&gt;.</span>
</pre></div>
</div>
</section>
<section id="div">
<h3><code class="docutils literal notranslate"><span class="pre">DIV</span></code><a class="headerlink" href="#div" title="Link to this heading"></a></h3>
<p>这是内容划分元素。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">DIV</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">,</span> <span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">),</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;div id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/div&gt;</span>
</pre></div>
</div>
</section>
<section id="em">
<h3><code class="docutils literal notranslate"><span class="pre">EM</span></code><a class="headerlink" href="#em" title="Link to this heading"></a></h3>
<p>强调其内容。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">EM</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">,</span> <span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">),</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;em id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/em&gt;</span>
</pre></div>
</div>
</section>
<section id="form">
<h3><code class="docutils literal notranslate"><span class="pre">FORM</span></code><a class="headerlink" href="#form" title="Link to this heading"></a></h3>
<p>使用此 helper 为用户输入制作表单。稍后将在专门的 <a class="reference internal" href="chapter-12.html#forms"><span class="std std-ref">表单（Forms）</span></a> 章节中详细讨论。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">FORM</span><span class="p">(</span><span class="n">INPUT</span><span class="p">(</span><span class="n">_type</span><span class="o">=</span><span class="s1">&#39;submit&#39;</span><span class="p">),</span> <span class="n">_action</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">_method</span><span class="o">=</span><span class="s1">&#39;post&#39;</span><span class="p">))</span>
<span class="go">&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input type=&quot;submit&quot;/&gt;&lt;/form&gt;</span>
</pre></div>
</div>
</section>
<section id="h1-h2-h3-h4-h5-h6">
<h3><code class="docutils literal notranslate"><span class="pre">H1</span></code>, <code class="docutils literal notranslate"><span class="pre">H2</span></code>, <code class="docutils literal notranslate"><span class="pre">H3</span></code>, <code class="docutils literal notranslate"><span class="pre">H4</span></code>, <code class="docutils literal notranslate"><span class="pre">H5</span></code>, <code class="docutils literal notranslate"><span class="pre">H6</span></code><a class="headerlink" href="#h1-h2-h3-h4-h5-h6" title="Link to this heading"></a></h3>
<p>这些 helpers 用于段落标题和副标题。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">H1</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">,</span> <span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">),</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;h1 id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/h1&gt;</span>
</pre></div>
</div>
</section>
<section id="head">
<h3><code class="docutils literal notranslate"><span class="pre">HEAD</span></code><a class="headerlink" href="#head" title="Link to this heading"></a></h3>
<p>用于标记 HTML 页面的头部。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">HEAD</span><span class="p">(</span><span class="n">TITLE</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">,</span> <span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">))))</span>
<span class="go">&lt;head&gt;&lt;title&gt;&amp;lt;hello&amp;gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/title&gt;&lt;/head&gt;</span>
</pre></div>
</div>
</section>
<section id="html">
<h3><code class="docutils literal notranslate"><span class="pre">HTML</span></code><a class="headerlink" href="#html" title="Link to this heading"></a></h3>
<p>用于标记一个 HTML 页面。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">BODY</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">,</span> <span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">))))</span>
<span class="go">&lt;html&gt;&lt;body&gt;&amp;lt;hello&amp;gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/body&gt;&lt;/html&gt;</span>
</pre></div>
</div>
</section>
<section id="i">
<h3><code class="docutils literal notranslate"><span class="pre">I</span></code><a class="headerlink" href="#i" title="Link to this heading"></a></h3>
<p>此 helper  将其内容设置为斜体。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">,</span> <span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">),</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;i id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/i&gt;</span>
</pre></div>
</div>
</section>
<section id="img">
<h3><code class="docutils literal notranslate"><span class="pre">IMG</span></code><a class="headerlink" href="#img" title="Link to this heading"></a></h3>
<p>它可以用来将图像嵌入 HTML。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IMG</span><span class="p">(</span><span class="n">_src</span><span class="o">=</span><span class="s1">&#39;http://example.com/image.png&#39;</span><span class="p">,</span> <span class="n">_alt</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">))</span>
<span class="go">&lt;img alt=&quot;test&quot; src=&quot;http://example.com/image.png&quot;/&gt;</span>
</pre></div>
</div>
<p>以下是 A、 IMG 和 URL 等 helpers 的组合，用于包含带有链接的静态图像：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">IMG</span><span class="p">(</span><span class="n">_src</span><span class="o">=</span><span class="n">URL</span><span class="p">(</span><span class="s1">&#39;static&#39;</span><span class="p">,</span> <span class="s1">&#39;logo.png&#39;</span><span class="p">),</span> <span class="n">_alt</span><span class="o">=</span><span class="s2">&quot;My Logo&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="n">_href</span><span class="o">=</span><span class="n">URL</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">)))</span>
<span class="go">&lt;a href=&quot;/default/index&quot;&gt;&lt;img alt=&quot;My Logo&quot; src=&quot;/static/logo.png&quot;/&gt;&lt;/a&gt;</span>
</pre></div>
</div>
</section>
<section id="input">
<h3><code class="docutils literal notranslate"><span class="pre">INPUT</span></code><a class="headerlink" href="#input" title="Link to this heading"></a></h3>
<p>创建一个 <code class="docutils literal notranslate"><span class="pre">&lt;input.../&gt;</span></code> 标签。输入标签可能不包含其他标记，并且由 <code class="docutils literal notranslate"><span class="pre">/&gt;</span></code> 而不是 <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> 结束。输入标签有一个可选的属性 <code class="docutils literal notranslate"><span class="pre">_type</span></code> 可以设置为 “text”（默认值）、“submit”、“checkbox” 或 “radio”。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">INPUT</span><span class="p">(</span><span class="n">_name</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_value</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="go">&lt;input name=&quot;test&quot; value=&quot;a&quot;/&gt;</span>
</pre></div>
</div>
<p>对于单选按钮，使用 <code class="docutils literal notranslate"><span class="pre">_checked</span></code> 属性以默认选中对应项目：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">INPUT</span><span class="p">(</span><span class="n">_type</span><span class="o">=</span><span class="s1">&#39;radio&#39;</span><span class="p">,</span> <span class="n">_name</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_value</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">_checked</span><span class="o">=</span><span class="n">v</span><span class="o">==</span><span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="n">v</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">&lt;input name=&quot;test&quot; type=&quot;radio&quot; value=&quot;a&quot;/&gt; a</span>
<span class="go">&lt;input checked=&quot;checked&quot; name=&quot;test&quot; type=&quot;radio&quot; value=&quot;b&quot;/&gt; b</span>
<span class="go">&lt;input name=&quot;test&quot; type=&quot;radio&quot; value=&quot;c&quot;/&gt; c</span>
</pre></div>
</div>
<p>对于复选框也是如此：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">INPUT</span><span class="p">(</span><span class="n">_type</span><span class="o">=</span><span class="s1">&#39;checkbox&#39;</span><span class="p">,</span> <span class="n">_name</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_value</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">_checked</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">&lt;input checked=&quot;checked&quot; name=&quot;test&quot; type=&quot;checkbox&quot; value=&quot;a&quot;/&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">INPUT</span><span class="p">(</span><span class="n">_type</span><span class="o">=</span><span class="s1">&#39;checkbox&#39;</span><span class="p">,</span> <span class="n">_name</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_value</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">_checked</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">&lt;input name=&quot;test&quot; type=&quot;checkbox&quot; value=&quot;a&quot;/&gt;</span>
</pre></div>
</div>
</section>
<section id="label">
<h3><code class="docutils literal notranslate"><span class="pre">LABEL</span></code><a class="headerlink" href="#label" title="Link to this heading"></a></h3>
<p>它被用于为 INPUT 字段创建 LABEL 标签。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">LABEL</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">,</span> <span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">),</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;label id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/label&gt;</span>
</pre></div>
</div>
</section>
<section id="li">
<h3><code class="docutils literal notranslate"><span class="pre">LI</span></code><a class="headerlink" href="#li" title="Link to this heading"></a></h3>
<p>它构成一个列表项，应包含在 <code class="docutils literal notranslate"><span class="pre">UL</span></code> 或 <code class="docutils literal notranslate"><span class="pre">OL</span></code> 标签中。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">LI</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">,</span> <span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">),</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;li id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/li&gt;</span>
</pre></div>
</div>
</section>
<section id="ol">
<h3><code class="docutils literal notranslate"><span class="pre">OL</span></code><a class="headerlink" href="#ol" title="Link to this heading"></a></h3>
<p>它代表有序列表。列表应包含 LI 标签。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">OL</span><span class="p">(</span><span class="n">LI</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">),</span> <span class="n">LI</span><span class="p">(</span><span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">)),</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;ol class=&quot;test&quot; id=&quot;0&quot;&gt;&lt;li&gt;&amp;lt;hello&amp;gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/li&gt;&lt;/ol&gt;</span>
</pre></div>
</div>
</section>
<section id="option">
<h3><code class="docutils literal notranslate"><span class="pre">OPTION</span></code><a class="headerlink" href="#option" title="Link to this heading"></a></h3>
<p>这仅用于 <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> 的参数。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">OPTION</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">,</span> <span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">),</span> <span class="n">_value</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="go">&lt;option value=&quot;a&quot;&gt;&amp;lt;hello&amp;gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/option&gt;</span>
</pre></div>
</div>
<p>对于选定的选项，使用 <code class="docutils literal notranslate"><span class="pre">_selected</span></code> 属性：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">OPTION</span><span class="p">(</span><span class="s1">&#39;Thank You&#39;</span><span class="p">,</span> <span class="n">_value</span><span class="o">=</span><span class="s1">&#39;ok&#39;</span><span class="p">,</span> <span class="n">_selected</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">&lt;option selected=&quot;selected&quot; value=&quot;ok&quot;&gt;Thank You&lt;/option&gt;</span>
</pre></div>
</div>
</section>
<section id="p">
<h3><code class="docutils literal notranslate"><span class="pre">P</span></code><a class="headerlink" href="#p" title="Link to this heading"></a></h3>
<p>这是用来标记段落的。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">,</span> <span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">),</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;p id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/p&gt;</span>
</pre></div>
</div>
</section>
<section id="pre">
<h3><code class="docutils literal notranslate"><span class="pre">PRE</span></code><a class="headerlink" href="#pre" title="Link to this heading"></a></h3>
<p>生成一个 <code class="docutils literal notranslate"><span class="pre">&lt;pre&gt;...&lt;/pre&gt;</span></code> 标签，以用于显示预格式化的文本。 <code class="docutils literal notranslate"><span class="pre">CODE</span></code> helper 通常更适合用于展示代码。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">SELECT</span><span class="p">(</span><span class="n">OPTION</span><span class="p">(</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="n">_value</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">),</span> <span class="n">OPTION</span><span class="p">(</span><span class="s1">&#39;second&#39;</span><span class="p">,</span> <span class="n">_value</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">),</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;pre id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/pre&gt;</span>
</pre></div>
</div>
</section>
<section id="script">
<h3><code class="docutils literal notranslate"><span class="pre">SCRIPT</span></code><a class="headerlink" href="#script" title="Link to this heading"></a></h3>
<p>这用于包含或链接脚本，如 JavaScript。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">SCRIPT</span><span class="p">(</span><span class="s1">&#39;console.log(&quot;hello world&quot;);&#39;</span><span class="p">,</span> <span class="n">_type</span><span class="o">=</span><span class="s1">&#39;text/javascript&#39;</span><span class="p">))</span>
<span class="go">&lt;script type=&quot;text/javascript&quot;&gt;console.log(&quot;hello world&quot;);&lt;/script&gt;</span>
</pre></div>
</div>
</section>
<section id="select">
<h3><code class="docutils literal notranslate"><span class="pre">SELECT</span></code><a class="headerlink" href="#select" title="Link to this heading"></a></h3>
<p>生成一个 <code class="docutils literal notranslate"><span class="pre">&lt;select&gt;...&lt;/select&gt;</span></code> 标签。这和 <code class="docutils literal notranslate"><span class="pre">OPTION</span></code> helper 一起使用。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">SELECT</span><span class="p">(</span><span class="n">OPTION</span><span class="p">(</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="n">_value</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">),</span> <span class="n">OPTION</span><span class="p">(</span><span class="s1">&#39;second&#39;</span><span class="p">,</span> <span class="n">_value</span><span class="o">=</span><span class="s1">&#39;2&#39;</span><span class="p">),</span>
<span class="gp">... </span><span class="n">_class</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;select class=&quot;test&quot; id=&quot;0&quot;&gt;&lt;option value=&quot;1&quot;&gt;first&lt;/option&gt;&lt;option value=&quot;2&quot;&gt;second&lt;/option&gt;&lt;/select&gt;</span>
</pre></div>
</div>
</section>
<section id="span">
<h3><code class="docutils literal notranslate"><span class="pre">SPAN</span></code><a class="headerlink" href="#span" title="Link to this heading"></a></h3>
<p>类似于 <code class="docutils literal notranslate"><span class="pre">DIV</span></code> ，但用于标记内联（行内的，而不是 <em>块</em> ）内容。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">,</span> <span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">),</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;span id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/span&gt;</span>
</pre></div>
</div>
</section>
<section id="style">
<h3><code class="docutils literal notranslate"><span class="pre">STYLE</span></code><a class="headerlink" href="#style" title="Link to this heading"></a></h3>
<p>类似于 <code class="docutils literal notranslate"><span class="pre">SCRIPT</span></code> ，但用于包含或链接 CSS 代码。这里包括 CSS：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">STYLE</span><span class="p">(</span><span class="n">XML</span><span class="p">(</span><span class="s1">&#39;body {color: white}&#39;</span><span class="p">)))</span>
<span class="go">&lt;style&gt;body {color: white}&lt;/style&gt;</span>
</pre></div>
</div>
<p>这里是链接:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">STYLE</span><span class="p">(</span><span class="n">_src</span><span class="o">=</span><span class="s1">&#39;style.css&#39;</span><span class="p">))</span>
<span class="go">&lt;style src=&quot;style.css&quot;&gt;&lt;/style&gt;</span>
</pre></div>
</div>
</section>
<section id="table-tr-td">
<h3><code class="docutils literal notranslate"><span class="pre">TABLE</span></code>, <code class="docutils literal notranslate"><span class="pre">TR</span></code>, <code class="docutils literal notranslate"><span class="pre">TD</span></code><a class="headerlink" href="#table-tr-td" title="Link to this heading"></a></h3>
<p>这些标签（以及可选的 <code class="docutils literal notranslate"><span class="pre">THEAD</span></code> 和 <code class="docutils literal notranslate"><span class="pre">TBODY</span></code> helpers）用于构建 HTML 表格。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">TR</span><span class="p">(</span><span class="n">TD</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">TD</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)),</span> <span class="n">TR</span><span class="p">(</span><span class="n">TD</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">),</span> <span class="n">TD</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">))))</span>
<span class="go">&lt;table&gt;&lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;b&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;c&lt;/td&gt;&lt;td&gt;d&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">TR</span></code> 需要有 <code class="docutils literal notranslate"><span class="pre">TD</span></code> 内容。</p>
<p>使用 Python 函数的 <code class="docutils literal notranslate"><span class="pre">*</span></code> 参数符号很容易将 Python 数组转换为 HTML 表格，该符号将列表元素映射到函数的位置参数。</p>
<p>在这里，我们将手动逐行实现：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">TR</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">TD</span><span class="p">,</span> <span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">TR</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">TD</span><span class="p">,</span> <span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">]))))</span>
<span class="go">&lt;table&gt;&lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;b&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;c&lt;/td&gt;&lt;td&gt;d&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</span>
</pre></div>
</div>
<p>在这里，我们使用迭代方式处理所有行：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">TR</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">TD</span><span class="p">,</span> <span class="n">rows</span><span class="p">))</span> <span class="k">for</span> <span class="n">rows</span> <span class="ow">in</span> <span class="n">table</span><span class="p">]))</span>
<span class="go">&lt;table&gt;&lt;tr&gt;&lt;td&gt;a&lt;/td&gt;&lt;td&gt;b&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;c&lt;/td&gt;&lt;td&gt;d&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</span>
</pre></div>
</div>
</section>
<section id="tbody">
<h3><code class="docutils literal notranslate"><span class="pre">TBODY</span></code><a class="headerlink" href="#tbody" title="Link to this heading"></a></h3>
<p>这用于标记表格主体中包含的行，而不是页眉或页脚中的行。这是可选的。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">TBODY</span><span class="p">(</span><span class="n">TR</span><span class="p">(</span><span class="n">TD</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">)),</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;tbody id=&quot;0&quot; class=&quot;test&quot;&gt;&lt;tr&gt;&lt;td&gt;&amp;lt;hello&amp;gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;</span>
</pre></div>
</div>
</section>
<section id="textarea">
<h3><code class="docutils literal notranslate"><span class="pre">TEXTAREA</span></code><a class="headerlink" href="#textarea" title="Link to this heading"></a></h3>
<p>此 helper 创建了一个 <code class="docutils literal notranslate"><span class="pre">&lt;textarea&gt;...&lt;/textarea&gt;</span></code> 标签。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">TEXTAREA</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">,</span> <span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">),</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span>
<span class="gp">... </span><span class="n">_cols</span><span class="o">=</span><span class="s2">&quot;40&quot;</span><span class="p">,</span> <span class="n">_rows</span><span class="o">=</span><span class="s2">&quot;10&quot;</span><span class="p">))</span>
<span class="go">&lt;textarea class=&quot;test&quot; cols=&quot;40&quot; rows=&quot;10&quot;&gt;&amp;lt;hello&amp;gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/textarea&gt;</span>
</pre></div>
</div>
</section>
<section id="th">
<h3><code class="docutils literal notranslate"><span class="pre">TH</span></code><a class="headerlink" href="#th" title="Link to this heading"></a></h3>
<p>这用于在表头中代替 <code class="docutils literal notranslate"><span class="pre">TD</span></code> 。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">,</span> <span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">),</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;th id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/th&gt;</span>
</pre></div>
</div>
</section>
<section id="thead">
<h3><code class="docutils literal notranslate"><span class="pre">THEAD</span></code><a class="headerlink" href="#thead" title="Link to this heading"></a></h3>
<p>这用于标记表头的行。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">THEAD</span><span class="p">(</span><span class="n">TR</span><span class="p">(</span><span class="n">TH</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">)),</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;thead id=&quot;0&quot; class=&quot;test&quot;&gt;&lt;tr&gt;&lt;th&gt;&amp;lt;hello&amp;gt;&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;</span>
</pre></div>
</div>
</section>
<section id="title">
<h3><code class="docutils literal notranslate"><span class="pre">TITLE</span></code><a class="headerlink" href="#title" title="Link to this heading"></a></h3>
<p>这用于在 HTML 头部中标记页面的标题。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">TITLE</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">,</span> <span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">)))</span>
<span class="go">&lt;title&gt;&amp;lt;hello&amp;gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/title&gt;</span>
</pre></div>
</div>
</section>
<section id="tt">
<h3><code class="docutils literal notranslate"><span class="pre">TT</span></code><a class="headerlink" href="#tt" title="Link to this heading"></a></h3>
<p>将文本标记为打字机（等宽）文本。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">TT</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">,</span> <span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">),</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;tt id=&quot;0&quot; class=&quot;test&quot;&gt;&amp;lt;hello&amp;gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/tt&gt;</span>
</pre></div>
</div>
</section>
<section id="ul">
<h3><code class="docutils literal notranslate"><span class="pre">UL</span></code><a class="headerlink" href="#ul" title="Link to this heading"></a></h3>
<p>它代表无序列表。列表应包含 LI 标签。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">UL</span><span class="p">(</span><span class="n">LI</span><span class="p">(</span><span class="s1">&#39;&lt;hello&gt;&#39;</span><span class="p">),</span> <span class="n">LI</span><span class="p">(</span><span class="n">XML</span><span class="p">(</span><span class="s1">&#39;&lt;strong&gt;world&lt;/strong&gt;&#39;</span><span class="p">)),</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">_id</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">&lt;ul class=&quot;test&quot; id=&quot;0&quot;&gt;&lt;li&gt;&amp;lt;hello&amp;gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;world&lt;/strong&gt;&lt;/li&gt;&lt;/ul&gt;</span>
</pre></div>
</div>
</section>
<section id="url">
<h3><code class="docutils literal notranslate"><span class="pre">URL</span></code><a class="headerlink" href="#url" title="Link to this heading"></a></h3>
<p>URL helper 不是 yatl 包的一部分，而是由 py4web 提供的。</p>
</section>
</section>
<section id="custom-helpers">
<h2>自定义 helper<a class="headerlink" href="#custom-helpers" title="Link to this heading"></a></h2>
<section id="tag">
<span id="id2"></span><h3><code class="docutils literal notranslate"><span class="pre">TAG</span></code><a class="headerlink" href="#tag" title="Link to this heading"></a></h3>
<p>有时需要生成自定义 XML 的标记。为此，py4web 提供了 <code class="docutils literal notranslate"><span class="pre">TAG</span></code> ，这是一个通用的标签生成器。</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[[=TAG.name(&#39;a&#39;, &#39;b&#39;, _c=&#39;d&#39;)]]
</pre></div>
</div>
<p>生成以下 XML：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;name</span><span class="w"> </span><span class="na">c=</span><span class="s">&quot;d&quot;</span><span class="nt">&gt;</span>ab<span class="nt">&lt;/name&gt;</span>
</pre></div>
</div>
<p>参数 “a”、“b” 和 “d” 会自动被转义；使用 <code class="docutils literal notranslate"><span class="pre">XML</span></code> helper 可以控制此行为。使用 <code class="docutils literal notranslate"><span class="pre">TAG</span></code> 可以生成 API 尚未提供的 HTML/XML 标记。TAG 可以嵌套，并使用 <code class="docutils literal notranslate"><span class="pre">str()</span></code> 进行序列化。等效语法为：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[[=TAG[&#39;name&#39;](&#39;a&#39;, &#39;b&#39;, _c=&#39;d&#39;)]]
</pre></div>
</div>
<p>可以使用 TAG helper 生成自闭标签。标记名称必须以 “/” 结尾。</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[[=TAG[&#39;link/&#39;](_href=&#39;http://py4web.com&#39;)]]
</pre></div>
</div>
<p>生成以下 XML：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;link</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;http://py4web.com&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>请注意， <code class="docutils literal notranslate"><span class="pre">TAG</span></code> 是一个对象， <code class="docutils literal notranslate"><span class="pre">TAG.name</span></code> 或 <code class="docutils literal notranslate"><span class="pre">TAG['name']</span></code> 是一个返回 helper 实例的函数。</p>
</section>
<section id="beautify">
<h3><code class="docutils literal notranslate"><span class="pre">BEAUTIFY</span></code><a class="headerlink" href="#beautify" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">BEAUTIFY</span></code> 用于构建复合对象的 HTML 表示，包括列表、元组和字典：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[[=BEAUTIFY({&quot;a&quot;: [&quot;hello&quot;, STRONG(&quot;world&quot;)], &quot;b&quot;: (1, 2)})]]
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">BEAUTIFY</span></code> 返回一个可序列化为 XML 的类 XML 对象，能使其构造函数参数具有美观的表示形式。在这种情况下，如下的 XML 内容：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="n">STRONG</span><span class="p">(</span><span class="s2">&quot;world&quot;</span><span class="p">)],</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)}</span>
</pre></div>
</div>
<p>将呈现为：</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">table</span><span class="p">&gt;&lt;</span><span class="nt">tbody</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;&lt;</span><span class="nt">th</span><span class="p">&gt;</span>a<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;&lt;</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">ul</span><span class="p">&gt;&lt;</span><span class="nt">li</span><span class="p">&gt;</span>hello<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>world<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;&lt;/</span><span class="nt">ul</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;&lt;</span><span class="nt">th</span><span class="p">&gt;</span>b<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;&lt;</span><span class="nt">td</span><span class="p">&gt;</span>(1, 2)<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">tbody</span><span class="p">&gt;&lt;/</span><span class="nt">table</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="server-side-dom">
<h2>服务器端的 <em>DOM</em><a class="headerlink" href="#server-side-dom" title="Link to this heading"></a></h2>
<p>正如我们已经看到的，py4web 中的 helper 机制还提供了文档对象模型（DOM）的服务器端表示。</p>
<section id="children">
<h3><code class="docutils literal notranslate"><span class="pre">children</span></code><a class="headerlink" href="#children" title="Link to this heading"></a></h3>
<p>每个 helper 对象都将其组件列表保存在 <code class="docutils literal notranslate"><span class="pre">children</span></code> 属性中。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">CAT</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="n">STRONG</span><span class="p">(</span><span class="s1">&#39;world&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">children</span>
<span class="go">[&#39;hello&#39;, &lt;yatl.helpers.TAGGER object at 0x7fa533ff7640&gt;]</span>
</pre></div>
</div>
</section>
<section id="find">
<h3><code class="docutils literal notranslate"><span class="pre">find</span></code><a class="headerlink" href="#find" title="Link to this heading"></a></h3>
<p>为了帮助搜索 DOM ，所有 helpers 都有一个带有以下签名的 <code class="docutils literal notranslate"><span class="pre">find</span></code> 方法：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">)</span>
</pre></div>
</div>
<p>它返回与提供的参数匹配的所有组件。</p>
<p>一个非常简单的 <code class="docutils literal notranslate"><span class="pre">query</span></code> 参数值可以是标签名称：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DIV</span><span class="p">(</span><span class="n">DIV</span><span class="p">(</span><span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">DIV</span><span class="p">(</span><span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">,</span> <span class="n">first_only</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;z&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># We should .xml() here instead of print</span>
<span class="go">&lt;div&gt;&lt;div&gt;&lt;span&gt;z&lt;/span&gt;3&lt;div&gt;&lt;span&gt;y&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">):</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;z&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&lt;div&gt;&lt;div&gt;&lt;span&gt;z&lt;/span&gt;3&lt;div&gt;&lt;span&gt;z&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span>
</pre></div>
</div>
<p>它还支持与 <a class="reference external" href="https://api.jquery.com/">jQuery</a> 兼容的语法，接受以下表达式：</p>
<ul class="simple">
<li><p><a class="reference external" href="https://api.jquery.com/multiple-selector/">jQuery 的多项选择器</a> ，例如 “Selector 1，Selector 2，Selector N”</p></li>
<li><p><a class="reference external" href="https://api.jquery.com/descendant-selector/">jQuery 的后代选择器</a> ，例如 “ancestor descendant”</p></li>
<li><p><a class="reference external" href="https://api.jquery.com/id-selector/">jQuery 的 ID 选择</a> ， 例如 “#id”</p></li>
<li><p><a class="reference external" href="https://api.jquery.com/class-selector/">jQuery 的样式的 Class 选择器</a> ， 例如 “.class”</p></li>
<li><p><a class="reference external" href="https://api.jquery.com/attribute-equals-selector/">jQuery 的属性等于选择器</a>，例如 “[name=value]” ，请注意，这里的值必须取消引号</p></li>
</ul>
<p>这是一些示例：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DIV</span><span class="p">(</span><span class="n">SPAN</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="p">:</span> <span class="s1">&#39;1-1&#39;</span><span class="p">,</span> <span class="s1">&#39;_u:v&#39;</span><span class="p">:</span> <span class="s1">&#39;$&#39;</span><span class="p">})),</span> <span class="n">P</span><span class="p">(</span><span class="s1">&#39;world&#39;</span><span class="p">,</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;this is a test&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div a#1-1, p.is&#39;</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">&lt;a id=&quot;1-1&quot; u:v=&quot;$&quot;&gt;hello&lt;/a&gt;</span>
<span class="go">&lt;p class=&quot;this is a test&quot;&gt;world&lt;/p&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;#1-1&#39;</span><span class="p">):</span> <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">&lt;a id=&quot;1-1&quot; u:v=&quot;$&quot;&gt;hello&lt;/a&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a[u:v=$]&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xml</span><span class="p">()</span>
<span class="go">&#39;&lt;a id=&quot;1-1&quot; u:v=&quot;$&quot;&gt;hello&lt;/a&gt;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">FORM</span><span class="p">(</span><span class="n">INPUT</span><span class="p">(</span><span class="n">_type</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">),</span> <span class="n">SELECT</span><span class="p">(</span><span class="n">OPTION</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span> <span class="n">TEXTAREA</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;input, select, textarea&#39;</span><span class="p">):</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;_disabled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">xml</span><span class="p">()</span>
<span class="go">&#39;&lt;form&gt;&lt;input disabled=&quot;disabled&quot; type=&quot;text&quot;/&gt;&lt;select disabled=&quot;disabled&quot;&gt;&lt;option&gt;0&lt;/option&gt;&lt;/select&gt;&lt;textarea disabled=&quot;disabled&quot;&gt;&lt;/textarea&gt;&lt;/form&gt;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;input, select, textarea&#39;</span><span class="p">):</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;_disabled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">xml</span><span class="p">()</span>
<span class="go">&#39;&lt;form&gt;&lt;input type=&quot;text&quot;/&gt;&lt;select&gt;&lt;option&gt;0&lt;/option&gt;&lt;/select&gt;&lt;textarea&gt;&lt;/textarea&gt;&lt;/form&gt;&#39;</span>
</pre></div>
</div>
<p>通过指定 <code class="docutils literal notranslate"><span class="pre">replace</span></code> 参数，也可以替换或删除匹配的元素（注意，原始匹配元素的列表仍然像往常一样返回）。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DIV</span><span class="p">(</span><span class="n">DIV</span><span class="p">(</span><span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">),</span> <span class="n">DIV</span><span class="p">(</span><span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">),</span> <span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;span.abc&#39;</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="n">P</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&lt;div&gt;&lt;div&gt;&lt;p class=&quot;xyz&quot;&gt;x&lt;/p&gt;&lt;div&gt;&lt;p class=&quot;xyz&quot;&gt;x&lt;/p&gt;&lt;p class=&quot;xyz&quot;&gt;x&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">replace</span></code> 可以是一个可调用函数，它将接收传递的原始元素，并应返回一个新元素来替换它。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DIV</span><span class="p">(</span><span class="n">DIV</span><span class="p">(</span><span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">),</span> <span class="n">DIV</span><span class="p">(</span><span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">),</span> <span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;span.abc&#39;</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="k">lambda</span> <span class="n">el</span><span class="p">:</span> <span class="n">P</span><span class="p">(</span><span class="n">el</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&lt;div&gt;&lt;div&gt;&lt;p class=&quot;xyz&quot;&gt;x&lt;/p&gt;&lt;div&gt;&lt;p class=&quot;xyz&quot;&gt;y&lt;/p&gt;&lt;p class=&quot;xyz&quot;&gt;z&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span>
</pre></div>
</div>
<p>如果是 <code class="docutils literal notranslate"><span class="pre">replace=None</span></code> ，则匹配的元素将被完全删除。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DIV</span><span class="p">(</span><span class="n">DIV</span><span class="p">(</span><span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">),</span> <span class="n">DIV</span><span class="p">(</span><span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">),</span> <span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&lt;div&gt;&lt;div&gt;&lt;span class=&quot;abc&quot;&gt;x&lt;/span&gt;&lt;div&gt;&lt;span class=&quot;abc&quot;&gt;&lt;/span&gt;&lt;span class=&quot;abc&quot;&gt;z&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span>
</pre></div>
</div>
<p>如果指定了 <code class="docutils literal notranslate"><span class="pre">text</span></code> 参数，则将在元素中搜索与 <code class="docutils literal notranslate"><span class="pre">text</span></code> 匹配的文本组件，并替换任何匹配的文本元素（如果未指定 <code class="docutils literal notranslate"><span class="pre">replace</span></code> ，则忽略 <code class="docutils literal notranslate"><span class="pre">text</span></code> ，当您只需要搜索文本元素时，请使用 <code class="docutils literal notranslate"><span class="pre">find</span></code> 参数）。</p>
<p>与 <code class="docutils literal notranslate"><span class="pre">find</span></code> 参数一样， <code class="docutils literal notranslate"><span class="pre">text</span></code> 可以是字符串或编译后的正则表达式。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DIV</span><span class="p">(</span><span class="n">DIV</span><span class="p">(</span><span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">),</span> <span class="n">DIV</span><span class="p">(</span><span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">),</span> <span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;x|y|z&#39;</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&lt;div&gt;&lt;div&gt;&lt;span class=&quot;abc&quot;&gt;hello&lt;/span&gt;&lt;div&gt;&lt;span class=&quot;abc&quot;&gt;hello&lt;/span&gt;&lt;span class=&quot;abc&quot;&gt;hello&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span>
</pre></div>
</div>
<p>如果其他属性与 <code class="docutils literal notranslate"><span class="pre">text</span></code> 一起指定，则只会搜索与指定属性匹配的组件以查找文本。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">DIV</span><span class="p">(</span><span class="n">DIV</span><span class="p">(</span><span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">),</span> <span class="n">DIV</span><span class="p">(</span><span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;efg&#39;</span><span class="p">),</span> <span class="n">SPAN</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">_class</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;span.efg&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;x|y|z&#39;</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&lt;div&gt;&lt;div&gt;&lt;span class=&quot;abc&quot;&gt;x&lt;/span&gt;&lt;div&gt;&lt;span class=&quot;efg&quot;&gt;hello&lt;/span&gt;&lt;span class=&quot;abc&quot;&gt;z&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="using-inject">
<h2>使用 <em>注入</em><a class="headerlink" href="#using-inject" title="Link to this heading"></a></h2>
<p>通常，所有代码都应从控制器程序调用，只有必要的数据才会传递给模板用来显示。但有时传递变量甚至使用 python 函数作为从模板中调用的 helper 是有用的。</p>
<p>在这种情况下，您可以使用 py4web.utils.factories 中的夹具 <code class="docutils literal notranslate"><span class="pre">Inject</span></code> 。</p>
<p>这是一个注入变量的简单示例：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">py4web.utils.factories</span><span class="w"> </span><span class="kn">import</span> <span class="n">Inject</span>

<span class="n">my_var</span> <span class="o">=</span> <span class="s2">&quot;Example variable to be passed to a Template&quot;</span>

<span class="o">...</span>

<span class="nd">@unauthenticated</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;index.html&quot;</span><span class="p">)</span>
<span class="nd">@action</span><span class="o">.</span><span class="n">uses</span><span class="p">(</span><span class="n">Inject</span><span class="p">(</span><span class="n">my_var</span><span class="o">=</span><span class="n">my_var</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">():</span>

   <span class="o">...</span>
</pre></div>
</div>
<p>然后在 <code class="docutils literal notranslate"><span class="pre">index.html</span></code> 中，你可以使用注入的变量：</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span>[[=my_var]]
</pre></div>
</div>
<p>您还可以使用 <code class="docutils literal notranslate"><span class="pre">Inject</span></code> 向 auth.enable 行添加变量；这样，auth 表单就可以访问该变量。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">auth</span><span class="o">.</span><span class="n">enable</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">Inject</span><span class="p">(</span><span class="n">TIMEOFFSET</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">TIMEOFFSET</span><span class="p">)))</span>
</pre></div>
</div>
<p><strong>注入（Inject）</strong> 的一个更复杂的用法是将 python 函数传递给模板。例如，如果你的 helper 函数被命名为 <strong>sidebar_menu</strong> ，它位于你的应用程序的 libs/helpers.py 模块中，你可以在 <strong>controllers.py</strong> 中使用它：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">py4web.utils.factories</span><span class="w"> </span><span class="kn">import</span> <span class="n">Inject</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.libs.helpers</span><span class="w"> </span><span class="kn">import</span> <span class="n">sidebar_menu</span>

<span class="nd">@action</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="nd">@action</span><span class="o">.</span><span class="n">uses</span><span class="p">(</span><span class="s2">&quot;index.html&quot;</span><span class="p">,</span> <span class="n">Inject</span><span class="p">(</span><span class="n">sidebar_menu</span><span class="o">=</span><span class="n">sidebar_menu</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">():</span> <span class="o">....</span>
</pre></div>
</div>
<p>或者</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">py4web.utils.factories</span><span class="w"> </span><span class="kn">import</span> <span class="n">Inject</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.libs</span><span class="w"> </span><span class="kn">import</span> <span class="n">helpers</span>

<span class="nd">@action</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="nd">@action</span><span class="o">.</span><span class="n">uses</span><span class="p">(</span><span class="n">Inject</span><span class="p">(</span><span class="o">**</span><span class="nb">vars</span><span class="p">(</span><span class="n">helpers</span><span class="p">)),</span> <span class="s2">&quot;index.html&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">index</span><span class="p">():</span> <span class="o">....</span>
</pre></div>
</div>
<p>然后，您可以以一种干净的方式在 index.html 模板中添加所需的代码：</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span>[[=sidebar_menu]]
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="页脚">
        <a href="chapter-09.html" class="btn btn-neutral float-left" title="YATL 模板语言" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="chapter-11.html" class="btn btn-neutral float-right" title="国际化" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2020, BSDv3 License。</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      
      
     <span class="fa fa-element">
     <input class="container_toggle" type="checkbox" id="switch" name="mode">
     <label for="switch"></label>
     </span>
      
      v: 20251209
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <dl>
        <dt>语言</dt>
        
           <strong> 
          <dd><a href="../en/index.html">en</a></dd> </strong>
          
        
          
          
          <dd><a href="../pt/index.html">pt</a></dd> 
        
          
          
          <dd><a href="../zh_CN/index.html">zh_CN</a></dd> 
        
      </dl>
      
      
      <dl>
        <dt>版本</dt>
        
          
          <dd><a href="index.html">current</a></dd>
          
        
      </dl>
      
      
      <dl>
        <dt>下载</dt>
        
          <dd><a href="py4web_en.pdf">pdf</a></dd>
        
          <dd><a href="py4web_en.epub">epub</a></dd>
        
      </dl>
      
      
      <hr/>
    </div>
  </div>

 <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

  <style>
         .wy-nav-content { max-width: none; }
  </style>



</body>
</html>